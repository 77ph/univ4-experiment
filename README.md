## Foundry

**Foundry is a blazing fast, portable and modular toolkit for Ethereum application development written in Rust.**

Foundry consists of:

-   **Forge**: Ethereum testing framework (like Truffle, Hardhat and DappTools).
-   **Cast**: Swiss army knife for interacting with EVM smart contracts, sending transactions and getting chain data.
-   **Anvil**: Local Ethereum node, akin to Ganache, Hardhat Network.
-   **Chisel**: Fast, utilitarian, and verbose solidity REPL.

## Documentation

https://book.getfoundry.sh/

## Usage

### Build

```shell
$ forge build
```

### Test

```shell
$ forge test
```

### Format

```shell
$ forge fmt
```

### Gas Snapshots

```shell
$ forge snapshot
```

### Anvil

```shell
$ anvil
```

### Deploy

```shell
$ forge script script/Counter.s.sol:CounterScript --rpc-url <your_rpc_url> --private-key <your_private_key>
```

### Cast

```shell
$ cast <subcommand>
```

### Help

```shell
$ forge --help
$ anvil --help
$ cast --help
```

### Bugs
```
forge test --fork-url https://bsc-dataseed.binance.org/ -vvvv
[⠊] Compiling...
[⠒] Compiling 2 files with Solc 0.8.26
[⠢] Solc 0.8.26 finished in 4.01s
Compiler run successful with warnings:
Warning (2072): Unused local variable.
  --> test/UniswapV4LiquidityHelper.t.sol:47:10:
   |
47 |         (bytes32 poolId, uint256 liquidity) = liquidityHelper.createUniswapPair(
   |          ^^^^^^^^^^^^^^


Ran 1 test for test/UniswapV4LiquidityHelper.t.sol:UniswapV4ForkTest
[FAIL: revert: TRANSFER_FROM_FAILED] testCreateUniswapPair() (gas: 486478)
Traces:
  [1990603] UniswapV4ForkTest::setUp()
    ├─ [0] VM::createSelectFork("<rpc url>")
    │   └─ ← [Return] 1
    ├─ [392644] → new MockERC20@0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f
    │   └─ ← [Return] 1732 bytes of code
    ├─ [46465] MockERC20::mint(UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1000000000000000000000000 [1e24])
    │   ├─ emit Transfer(from: 0x0000000000000000000000000000000000000000, to: UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 1000000000000000000000000 [1e24])
    │   └─ ← [Stop] 
    ├─ [392644] → new MockERC20@0x2e234DAe75C793f67A35089C9d99245E1C58470b
    │   └─ ← [Return] 1732 bytes of code
    ├─ [46465] MockERC20::mint(UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1000000000000000000000000 [1e24])
    │   ├─ emit Transfer(from: 0x0000000000000000000000000000000000000000, to: UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], value: 1000000000000000000000000 [1e24])
    │   └─ ← [Stop] 
    ├─ [903527] → new UniswapV4LiquidityHelper@0xF62849F9A0B5Bf2913b396098F7c7019b51A820a
    │   ├─ emit OwnershipTransferred(previousOwner: 0x0000000000000000000000000000000000000000, newOwner: UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   ├─ emit OwnershipTransferred(previousOwner: UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], newOwner: UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   └─ ← [Return] 4382 bytes of code
    ├─ [24325] MockERC20::approve(UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─ emit Approval(owner: UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], value: 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   └─ ← [Return] true
    ├─ [24325] MockERC20::approve(UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─ emit Approval(owner: UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], value: 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   └─ ← [Return] true
    └─ ← [Return] 

  [486478] UniswapV4ForkTest::testCreateUniswapPair()
    ├─ [2537] MockERC20::balanceOf(UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496]) [staticcall]
    │   └─ ← [Return] 1000000000000000000000000 [1e24]
    ├─ [469518] UniswapV4LiquidityHelper::createUniswapPair(MockERC20: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], MockERC20: [0x2e234DAe75C793f67A35089C9d99245E1C58470b], 1000000000000000000000 [1e21], 1000000000000000000000 [1e21])
    │   ├─ [29896] MockERC20::transferFrom(UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], 1000000000000000000000 [1e21])
    │   │   ├─ emit Transfer(from: UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], value: 1000000000000000000000 [1e21])
    │   │   └─ ← [Return] true
    │   ├─ [31896] MockERC20::transferFrom(UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], 1000000000000000000000 [1e21])
    │   │   ├─ emit Transfer(from: UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], to: UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], value: 1000000000000000000000 [1e21])
    │   │   └─ ← [Return] true
    │   ├─ [2375] 0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF::extsload(0x69e049334ba1c9a7b737a691947a035b83cd7f7079016fc356fd74edad22a523) [staticcall]
    │   │   └─ ← [Return] 0x0000000000000000000000000000000000000000000000000000000000000000
    │   ├─ [27172] 0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF::initialize(PoolKey({ currency0: 0x2e234DAe75C793f67A35089C9d99245E1C58470b, currency1: 0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f, fee: 10000 [1e4], tickSpacing: 200, hooks: 0x0000000000000000000000000000000000000000 }), 79228162514264337593543950336 [7.922e28])
    │   │   ├─ emit Initialize(id: 0xd41d79d94c12e7d5638388ff203ea0f9c4b1f8654fb6703cab294f75d29204ae, currency0: MockERC20: [0x2e234DAe75C793f67A35089C9d99245E1C58470b], currency1: MockERC20: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], fee: 10000 [1e4], tickSpacing: 200, hooks: 0x0000000000000000000000000000000000000000, sqrtPriceX96: 79228162514264337593543950336 [7.922e28], tick: 0)
    │   │   └─ ← [Return] 0
    │   ├─ emit PoolCreated(poolId: 0xd41d79d94c12e7d5638388ff203ea0f9c4b1f8654fb6703cab294f75d29204ae)
    │   ├─ [25450] 0x000000000022D473030F116dDEE9F6B43aC78BA3::approve(MockERC20: [0x2e234DAe75C793f67A35089C9d99245E1C58470b], 0x7A4a5c919aE2541AeD11041A1AEeE68f1287f95b, 1000000000000000000000 [1e21], 1740430407 [1.74e9])
    │   │   ├─ emit Approval(owner: UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], token: MockERC20: [0x2e234DAe75C793f67A35089C9d99245E1C58470b], spender: 0x7A4a5c919aE2541AeD11041A1AEeE68f1287f95b, amount: 1000000000000000000000 [1e21], expiration: 1740430407 [1.74e9])
    │   │   └─ ← [Return] 
    │   ├─ [25450] 0x000000000022D473030F116dDEE9F6B43aC78BA3::approve(MockERC20: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 0x7A4a5c919aE2541AeD11041A1AEeE68f1287f95b, 1000000000000000000000 [1e21], 1740430407 [1.74e9])
    │   │   ├─ emit Approval(owner: UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], token: MockERC20: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], spender: 0x7A4a5c919aE2541AeD11041A1AEeE68f1287f95b, amount: 1000000000000000000000 [1e21], expiration: 1740430407 [1.74e9])
    │   │   └─ ← [Return] 
    │   ├─ [305017] 0x7A4a5c919aE2541AeD11041A1AEeE68f1287f95b::modifyLiquidities(0x000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000002020d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000002e234dae75c793f67a35089c9d99245e1c58470b0000000000000000000000005615deb798bb3e4dfa0139dfa1b3d433cc23b72f000000000000000000000000000000000000000000000000000000000000271000000000000000000000000000000000000000000000000000000000000000c80000000000000000000000000000000000000000000000000000000000000000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffff2766000000000000000000000000000000000000000000000000000000000000d89a000000000000000000000000000000000000000000000003635c9adc5dea0003600000000000000000000000000000000000000000000003635c9adc5dea0000000000000000000000000000000000000000000000000003635c9adc5dea000000000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e14960000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000002e234dae75c793f67a35089c9d99245e1c58470b0000000000000000000000005615deb798bb3e4dfa0139dfa1b3d433cc23b72f, 1740350007 [1.74e9])
    │   │   ├─ [303157] 0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF::unlock(0x000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000002020d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000002e234dae75c793f67a35089c9d99245e1c58470b0000000000000000000000005615deb798bb3e4dfa0139dfa1b3d433cc23b72f000000000000000000000000000000000000000000000000000000000000271000000000000000000000000000000000000000000000000000000000000000c80000000000000000000000000000000000000000000000000000000000000000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffff2766000000000000000000000000000000000000000000000000000000000000d89a000000000000000000000000000000000000000000000003635c9adc5dea0003600000000000000000000000000000000000000000000003635c9adc5dea0000000000000000000000000000000000000000000000000003635c9adc5dea000000000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e14960000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000002e234dae75c793f67a35089c9d99245e1c58470b0000000000000000000000005615deb798bb3e4dfa0139dfa1b3d433cc23b72f)
    │   │   │   ├─ [301874] 0x7A4a5c919aE2541AeD11041A1AEeE68f1287f95b::unlockCallback(0x000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000002020d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000002e234dae75c793f67a35089c9d99245e1c58470b0000000000000000000000005615deb798bb3e4dfa0139dfa1b3d433cc23b72f000000000000000000000000000000000000000000000000000000000000271000000000000000000000000000000000000000000000000000000000000000c80000000000000000000000000000000000000000000000000000000000000000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffff2766000000000000000000000000000000000000000000000000000000000000d89a000000000000000000000000000000000000000000000003635c9adc5dea0003600000000000000000000000000000000000000000000003635c9adc5dea0000000000000000000000000000000000000000000000000003635c9adc5dea000000000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e14960000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000002e234dae75c793f67a35089c9d99245e1c58470b0000000000000000000000005615deb798bb3e4dfa0139dfa1b3d433cc23b72f)
    │   │   │   │   ├─ emit Transfer(param0: 0x0000000000000000000000000000000000000000, param1: UniswapV4ForkTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], param2: 1944)
    │   │   │   │   ├─ [164122] 0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF::modifyLiquidity(PoolKey({ currency0: 0x2e234DAe75C793f67A35089C9d99245E1C58470b, currency1: 0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f, fee: 10000 [1e4], tickSpacing: 200, hooks: 0x0000000000000000000000000000000000000000 }), ModifyLiquidityParams({ tickLower: -887200 [-8.872e5], tickUpper: 887200 [8.872e5], liquidityDelta: 1000000000000000000054 [1e21], salt: 0x0000000000000000000000000000000000000000000000000000000000000798 }), 0x)
    │   │   │   │   │   ├─ emit ModifyLiquidity(id: 0xd41d79d94c12e7d5638388ff203ea0f9c4b1f8654fb6703cab294f75d29204ae, sender: 0x7A4a5c919aE2541AeD11041A1AEeE68f1287f95b, tickLower: -887200 [-8.872e5], tickUpper: 887200 [8.872e5], liquidityDelta: 1000000000000000000054 [1e21], salt: 0x0000000000000000000000000000000000000000000000000000000000000798)
    │   │   │   │   │   └─ ← [Return] -340282366920938463463034325064847272993536625392568231788544 [-3.402e59], 0
    │   │   │   │   ├─ [859] 0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF::exttload(0xdcab09d7d42483653e190f9a166b081b20548e581faca6eaaac23f61cc215a4e) [staticcall]
    │   │   │   │   │   └─ ← [Return] 0xffffffffffffffffffffffffffffffffffffffffffffffc9ca36523a21600000
    │   │   │   │   ├─ [3910] 0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF::sync(MockERC20: [0x2e234DAe75C793f67A35089C9d99245E1C58470b])
    │   │   │   │   │   ├─ [2537] MockERC20::balanceOf(0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF) [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 0
    │   │   │   │   │   └─ ← [Stop] 
    │   │   │   │   ├─ [4155] 0x000000000022D473030F116dDEE9F6B43aC78BA3::transferFrom(UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], 0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF, 1000000000000000000000 [1e21], MockERC20: [0x2e234DAe75C793f67A35089C9d99245E1C58470b])
    │   │   │   │   │   ├─ [2720] MockERC20::transferFrom(UniswapV4LiquidityHelper: [0xF62849F9A0B5Bf2913b396098F7c7019b51A820a], 0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF, 1000000000000000000000 [1e21])
    │   │   │   │   │   │   └─ ← [Revert] ERC20InsufficientAllowance(0x000000000022D473030F116dDEE9F6B43aC78BA3, 0, 1000000000000000000000 [1e21])
    │   │   │   │   │   └─ ← [Revert] revert: TRANSFER_FROM_FAILED
    │   │   │   │   └─ ← [Revert] revert: TRANSFER_FROM_FAILED
    │   │   │   └─ ← [Revert] revert: TRANSFER_FROM_FAILED
    │   │   └─ ← [Revert] revert: TRANSFER_FROM_FAILED
    │   └─ ← [Revert] revert: TRANSFER_FROM_FAILED
    └─ ← [Revert] revert: TRANSFER_FROM_FAILED

Suite result: FAILED. 0 passed; 1 failed; 0 skipped; finished in 4.35s (2.27s CPU time)

Ran 1 test suite in 6.00s (4.35s CPU time): 0 tests passed, 1 failed, 0 skipped (1 total tests)

Failing tests:
Encountered 1 failing test in test/UniswapV4LiquidityHelper.t.sol:UniswapV4ForkTest
[FAIL: revert: TRANSFER_FROM_FAILED] testCreateUniswapPair() (gas: 486478)

Encountered a total of 1 failing tests, 0 tests succeeded
```
